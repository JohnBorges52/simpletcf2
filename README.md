## Firebase config (local & CI)

This project expects a generated `public/firebase-config.js` at runtime. The file is generated by `scripts/generate-firebase-config.js` and is ignored from git.

Secrets (set these in GitHub Actions as repository secrets):
- `FIREBASE_API_KEY`
- `FIREBASE_AUTHDOMAIN`
- `FIREBASE_PROJECTID`
- `FIREBASE_STORAGEBUCKET`
- `FIREBASE_MESSAGINGSENDERID`
- `FIREBASE_APPID`
- `FIREBASE_MEASUREMENTID`

Local development:
1. Create a `.env` or set env vars locally.
2. Run:

```bash
npm run generate-config
```

This writes `public/firebase-config.js` which the client code reads automatically.

Removing accidentally committed secrets:
- If secrets were committed previously, remove them from your git history (use `git filter-repo` or the BFG repo cleaner), rotate the exposed credentials, and invalidate any tokens.
- For CI (Cloud Build/GitHub Actions) prefer project/secret managers or repository secrets instead of hardcoding values in repo files.

## ‚ö†Ô∏è IMPORTANT: Deploy Updated Firestore Rules

**Recent Fix (PR #6):** Firestore security rules were updated to fix permission errors. You MUST deploy the updated rules:

```bash
firebase deploy --only firestore:rules
```

See [DEPLOY_FIRESTORE_RULES.md](DEPLOY_FIRESTORE_RULES.md) for detailed deployment instructions.

## Firestore Database Setup

**Quick Answer:** YES, you need to enable Firestore in Firebase Console!

### Required Steps:

1. **Enable Firestore** in [Firebase Console](https://console.firebase.google.com/):
   - Go to Build ‚Üí Firestore Database
   - Click "Create database"
   - Choose "Start in production mode"
   - Select your region
   - Click "Enable"

2. **Deploy security rules** (REQUIRED after recent update):
   ```bash
   firebase deploy --only firestore:rules
   ```
   üìñ **See detailed guide:** [DEPLOY_FIRESTORE_RULES.md](DEPLOY_FIRESTORE_RULES.md)

3. **Deploy Firestore indexes** (REQUIRED for statistics to work):
   ```bash
   firebase deploy --only firestore:indexes
   ```
   üìñ **See detailed guide:** [DEPLOY_FIRESTORE_INDEXES.md](DEPLOY_FIRESTORE_INDEXES.md)

4. **Use the app** - Collections and documents are created automatically when:
   - Users register/login (creates `/users/{userId}`)
   - Users answer questions (creates `/questionResponses/{responseId}`)

### Documentation:

- üöÄ **DEPLOY RULES:** [DEPLOY_FIRESTORE_RULES.md](DEPLOY_FIRESTORE_RULES.md) - Deploy updated rules to Google Cloud
- üîç **DEPLOY INDEXES:** [DEPLOY_FIRESTORE_INDEXES.md](DEPLOY_FIRESTORE_INDEXES.md) - Deploy indexes for statistics (REQUIRED)
- üìã **Checklist:** [FIRESTORE_CHECKLIST.md](FIRESTORE_CHECKLIST.md) - Step-by-step setup checklist
- üìñ **Quick Start:** [FIRESTORE_QUICKSTART.md](FIRESTORE_QUICKSTART.md) - "Do I need to create a database?"
- üìö **Setup Guide:** [FIRESTORE_SETUP.md](FIRESTORE_SETUP.md) - Detailed setup instructions
- üóÑÔ∏è **Database Schema:** [FIRESTORE_DATABASE.md](FIRESTORE_DATABASE.md) - Complete API reference
- ‚úÖ **Implementation:** [FIRESTORE_IMPLEMENTATION.md](FIRESTORE_IMPLEMENTATION.md) - What was built

**Note:** You don't need to manually create collections or documents - they're created automatically by the application code!

