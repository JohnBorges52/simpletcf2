<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Review Your Order</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="checkout.css" />
    <link rel="stylesheet" href="stripe-checkout-styles.css" />
    <!-- Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
  </head>

  <body class="checkout-page">
    <div class="checkout-container">
      <!-- Header -->
      <header class="checkout-header">
        <div class="checkout-header-brand">
          <div class="checkout-brand-badge" aria-hidden="true">
            <!-- Shopping cart icon -->
            <svg
              class="checkout-icon checkout-icon-md checkout-text-purple"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              role="img"
              aria-label="Cart"
            >
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path
                d="M1 1h4l2.68 12.39a2 2 0 0 0 2 1.61h7.72a2 2 0 0 0 2-1.61L23 6H6"
              ></path>
            </svg>
          </div>
          <h1 class="checkout-title">Review Your Order</h1>
        </div>
      </header>

      <main class="checkout">
        <section class="card">
          <!-- ===== Order Summary (namespaced) ===== -->
          <section class="order-summary-card">
            <header class="order-summary-card__header">
              <div class="card__row">
                <a href="/plan.html" class="back">
                  <svg
                    class="back__icon"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    aria-hidden="true"
                  >
                    <path
                      d="M15 18l-6-6 6-6"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <span class="back__text">Back</span>
                </a>
              </div>
              <h2 class="order-summary-title">Order Summary</h2>

              <!-- Signed-in user -->
              <div class="signedin">
                <p id="signedin__hint__id" class="signedin__hint"></p>
                <!-- <p class="signedin__email"></p> -->
              </div>
            </header>

            <div class="order-summary-card__body">
              <!-- Package Details (all tiers pre-rendered, only one visible) -->
              <div class="order-summary-block order-summary-block--pkg">
                <div class="order-summary-row">
                  <div class="order-summary-col">
                    <!-- FREE -->
                    <div
                      class="order-summary-package order-summary-package--free"
                    >
                      <div class="order-summary-badges">
                        <span
                          class="order-summary-badge order-summary-badge--free"
                        ></span>
                      </div>
                      <p class="order-summary-text"></p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Pricing Breakdown -->
              <div class="order-summary-block order-summary-block--breakdown">
                <div class="order-summary-line">
                  <span class="order-summary-label">Package Price</span>
                  <span class="order-summary-value"></span>
                </div>

                <div class="order-summary-line">
                  <span class="order-summary-label">Platform Fee (2.5%)</span>
                  <span id="platformFeeId" class="order-summary-value"></span>
                </div>

                <div class="order-summary-line order-summary-line--sep">
                  <span class="order-summary-label">Subtotal</span>
                  <span id="subtotalId" class="order-summary-value"></span>
                </div>

                <div class="order-summary-line">
                  <span class="order-summary-label">GST (5%)</span>
                  <span id="gstId" class="order-summary-value"></span>
                </div>

                <div class="order-summary-line">
                  <span class="order-summary-label">PST (7%)</span>
                  <span id="pstId" class="order-summary-value"></span>
                </div>

                <div class="order-summary-line order-summary-line--total">
                  <span class="order-summary-total-label">Total</span>
                  <span id="totalId" class="order-summary-total-value"></span>
                </div>
              </div>

              <!-- Additional Info -->
              <div class="order-summary-info">
                <div class="order-summary-info__icon">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                    class="order-summary-info__svg"
                  >
                    <circle
                      cx="12"
                      cy="12"
                      r="10"
                      stroke="currentColor"
                      stroke-width="2"
                      fill="none"
                    ></circle>
                    <path
                      d="M12 16v-4M12 8h.01"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></path>
                  </svg>
                </div>
                <div class="order-summary-info__text">
                  <p class="order-summary-info__title">Secure Payment</p>
                  <p>
                    Your payment information is encrypted and secure. You will
                    receive a confirmation email after successful payment.
                  </p>
                </div>
              </div>
            </div>
          </section>

          <!-- ===== Payment Section ===== -->
          <section
            id="paymentSection"
            aria-labelledby="payment-heading"
            class="card__body"
          >
            <h2 id="payment-heading" class="h2">Your payment method</h2>

            <!-- Brand icons -->
            <div class="brands" aria-hidden="true">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png"
                alt="Visa"
              />
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png"
                alt="Mastercard"
              />
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/PayPal.svg/2560px-PayPal.svg.png"
                alt="PayPal"
              />
            </div>

            <!-- Stripe Checkout Information -->
            <div class="stripe-checkout-info">
              <div class="stripe-checkout-header">
                <svg class="stripe-icon" viewBox="0 0 60 25" xmlns="http://www.w3.org/2000/svg" width="60" height="25">
                  <path fill="#635BFF" fill-rule="evenodd" d="M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.2 2.55 1.64 0 2.96-.37 4.05-.95v3.32a8.33 8.33 0 0 1-4.56 1.1c-4.01 0-6.83-2.5-6.83-7.48 0-4.19 2.39-7.52 6.3-7.52 3.92 0 5.96 3.28 5.96 7.5 0 .4-.04 1.26-.06 1.48zm-5.92-5.62c-1.03 0-2.17.73-2.17 2.58h4.25c0-1.85-1.07-2.58-2.08-2.58zM40.95 20.3c-1.44 0-2.32-.6-2.9-1.04l-.02 4.63-4.12.87V5.57h3.76l.08 1.02a4.7 4.7 0 0 1 3.23-1.29c2.9 0 5.62 2.6 5.62 7.4 0 5.23-2.7 7.6-5.65 7.6zM40 8.95c-.95 0-1.54.34-1.97.81l.02 6.12c.4.44.98.78 1.95.78 1.52 0 2.54-1.65 2.54-3.87 0-2.15-1.04-3.84-2.54-3.84zM28.24 5.57h4.13v14.44h-4.13V5.57zm0-4.7L32.37 0v3.36l-4.13.88V.88zm-4.32 9.35v9.79H19.8V5.57h3.7l.12 1.22c1-1.77 3.07-1.41 3.62-1.22v3.79c-.52-.17-2.29-.43-3.32.86zm-8.55 4.72c0 2.43 2.6 1.68 3.12 1.46v3.36c-.55.3-1.54.54-2.89.54a4.15 4.15 0 0 1-4.27-4.24l.01-13.17 4.02-.86v3.54h3.14V9.1h-3.13v5.85zm-4.91.7c0 2.97-2.31 4.66-5.73 4.66a11.2 11.2 0 0 1-4.46-.93v-3.93c1.38.75 3.1 1.31 4.46 1.31.92 0 1.53-.24 1.53-1C6.26 13.77 0 14.51 0 9.95 0 7.04 2.28 5.3 5.62 5.3c1.36 0 2.72.2 4.09.75v3.88a9.23 9.23 0 0 0-4.1-1.06c-.86 0-1.44.25-1.44.9 0 1.85 6.29.97 6.29 5.88z" clip-rule="evenodd"/>
                </svg>
                <h3>Secure Payment Powered by Stripe</h3>
              </div>
              
              <div class="stripe-checkout-message">
                <p class="stripe-text-primary">You'll be redirected to Stripe's secure checkout page to complete your payment.</p>
                <p class="stripe-text-secondary">Stripe accepts all major credit cards and PayPal.</p>
              </div>

              <div class="stripe-security-badges">
                <div class="security-badge">
                  <svg class="security-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                  </svg>
                  <span>256-bit SSL Encrypted</span>
                </div>
                <div class="security-badge">
                  <svg class="security-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                    <path d="M9 12l2 2 4-4"></path>
                  </svg>
                  <span>PCI DSS Compliant</span>
                </div>
              </div>

              <div class="actions">
                <button id="completePaymentBtn" type="button" class="btn btn--primary btn--stripe">
                  <span>Continue to Secure Checkout</span>
                  <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                  </svg>
                </button>
              </div>

              <p class="stripe-footnote">
                <svg class="info-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                Your payment details are never stored on our servers. All transactions are processed securely by Stripe.
              </p>
            </div>
          </section>
        </section>
      </main>

      <!-- Security Notice spacer (kept) -->
      <div
        class="checkout-center-row checkout-gap-2 checkout-mb-6 checkout-text-sm"
      ></div>
    </div>

    <!-- Firebase initialization (config hardcoded) -->
    <script type="module" src="config.js"></script>
    <script type="module" src="db-service.js"></script>
    <script src="subscription-service.js"></script>
    <!-- Stripe payment service -->
    <script src="stripe-service.js"></script>
    <!-- Then app scripts -->
    <script type="module" src="script.js"></script>
    <script type="module" src="checkout.js"></script>
  </body>
</html>
