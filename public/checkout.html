<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Review Your Order</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="checkout.css" />
    <link rel="stylesheet" href="stripe-checkout-styles.css" />
    <!-- Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
  </head>

  <body class="checkout-page">
    <div class="checkout-container">
      <!-- Header -->
      <header class="checkout-header">
        <div class="checkout-header-brand">
          <div class="checkout-brand-badge" aria-hidden="true">
            <!-- Shopping cart icon -->
            <svg
              class="checkout-icon checkout-icon-md checkout-text-purple"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              role="img"
              aria-label="Cart"
            >
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path
                d="M1 1h4l2.68 12.39a2 2 0 0 0 2 1.61h7.72a2 2 0 0 0 2-1.61L23 6H6"
              ></path>
            </svg>
          </div>
          <h1 class="checkout-title">Review Your Order</h1>
        </div>
      </header>

      <main class="checkout">
        <section class="card">
          <!-- ===== Order Summary (namespaced) ===== -->
          <section class="order-summary-card">
            <header class="order-summary-card__header">
              <div class="card__row">
                <a href="/plan" class="back">
                  <svg
                    class="back__icon"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    aria-hidden="true"
                  >
                    <path
                      d="M15 18l-6-6 6-6"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <span class="back__text">Back</span>
                </a>
              </div>
              <h2 class="order-summary-title">Order Summary</h2>
              <p style="font-size: 0.85rem; color: #666; margin-top: 4px; font-weight: 500;">ðŸ’° Prices and totals shown in Canadian Dollars (CAD)</p>

              <!-- Signed-in user -->
              <div class="signedin">
                <p id="signedin__hint__id" class="signedin__hint"></p>
                <!-- <p class="signedin__email"></p> -->
              </div>
            </header>

            <div class="order-summary-card__body">
              <!-- Package Details (all tiers pre-rendered, only one visible) -->
              <div class="order-summary-block order-summary-block--pkg">
                <div class="order-summary-row">
                  <div class="order-summary-col">
                    <!-- FREE -->
                    <div
                      class="order-summary-package order-summary-package--free"
                    >
                      <div class="order-summary-badges">
                        <span
                          class="order-summary-badge order-summary-badge--free"
                        ></span>
                      </div>
                      <p class="order-summary-text"></p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Pricing Breakdown -->
              <div class="order-summary-block order-summary-block--breakdown">
                <div class="order-summary-line">
                  <span class="order-summary-label">Package Price</span>
                  <span class="order-summary-value"></span>
                </div>

                <div class="order-summary-line">
                  <span class="order-summary-label">Platform Fee (2.95%)</span>
                  <span id="platformFeeId" class="order-summary-value"></span>
                </div>

                <div class="order-summary-line order-summary-line--total">
                  <span class="order-summary-total-label">Total</span>
                  <span id="totalId" class="order-summary-total-value"></span>
                </div>
              </div>

            </div>
          </section>

          <!-- ===== Payment Section ===== -->
          <section
            id="paymentSection"
            aria-labelledby="payment-heading"
            class="card__body"
          >
            <h2 id="payment-heading" class="h2">Your payment method</h2>

            <!-- Brand icons -->
            <div class="brands" aria-hidden="true">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png"
                alt="Visa"
              />
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png"
                alt="Mastercard"
              />
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/PayPal.svg/2560px-PayPal.svg.png"
                alt="PayPal"
              />
            </div>

            <!-- Stripe Checkout Information -->
            <div class="stripe-checkout-info">
              <div class="stripe-checkout-header">
                <svg class="stripe-icon" viewBox="0 0 60 25" xmlns="http://www.w3.org/2000/svg" width="60" height="25">
                  <path fill="#635BFF" fill-rule="evenodd" d="M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.2 2.55 1.64 0 2.96-.37 4.05-.95v3.32a8.33 8.33 0 0 1-4.56 1.1c-4.01 0-6.83-2.5-6.83-7.48 0-4.19 2.39-7.52 6.3-7.52 3.92 0 5.96 3.28 5.96 7.5 0 .4-.04 1.26-.06 1.48zm-5.92-5.62c-1.03 0-2.17.73-2.17 2.58h4.25c0-1.85-1.07-2.58-2.08-2.58zM40.95 20.3c-1.44 0-2.32-.6-2.9-1.04l-.02 4.63-4.12.87V5.57h3.76l.08 1.02a4.7 4.7 0 0 1 3.23-1.29c2.9 0 5.62 2.6 5.62 7.4 0 5.23-2.7 7.6-5.65 7.6zM40 8.95c-.95 0-1.54.34-1.97.81l.02 6.12c.4.44.98.78 1.95.78 1.52 0 2.54-1.65 2.54-3.87 0-2.15-1.04-3.84-2.54-3.84zM28.24 5.57h4.13v14.44h-4.13V5.57zm0-4.7L32.37 0v3.36l-4.13.88V.88zm-4.32 9.35v9.79H19.8V5.57h3.7l.12 1.22c1-1.77 3.07-1.41 3.62-1.22v3.79c-.52-.17-2.29-.43-3.32.86zm-8.55 4.72c0 2.43 2.6 1.68 3.12 1.46v3.36c-.55.3-1.54.54-2.89.54a4.15 4.15 0 0 1-4.27-4.24l.01-13.17 4.02-.86v3.54h3.14V9.1h-3.13v5.85zm-4.91.7c0 2.97-2.31 4.66-5.73 4.66a11.2 11.2 0 0 1-4.46-.93v-3.93c1.38.75 3.1 1.31 4.46 1.31.92 0 1.53-.24 1.53-1C6.26 13.77 0 14.51 0 9.95 0 7.04 2.28 5.3 5.62 5.3c1.36 0 2.72.2 4.09.75v3.88a9.23 9.23 0 0 0-4.1-1.06c-.86 0-1.44.25-1.44.9 0 1.85 6.29.97 6.29 5.88z" clip-rule="evenodd"/>
                </svg>
                <h3>Secure Payment Powered by Stripe</h3>
              </div>
              
              <div class="stripe-checkout-message">
                <p class="stripe-text-primary">You'll be redirected to Stripe's secure checkout page to complete your payment.</p>
                <p class="stripe-text-secondary">Stripe accepts all major credit cards and PayPal.</p>
              </div>

              <div class="stripe-security-badges">
                <div class="security-badge">
                  <svg class="security-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                  </svg>
                  <span>256-bit SSL Encrypted</span>
                </div>
                <div class="security-badge">
                  <svg class="security-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                    <path d="M9 12l2 2 4-4"></path>
                  </svg>
                  <span>PCI DSS Compliant</span>
                </div>
              </div>

              <div class="actions">
                <button id="completePaymentBtn" type="button" class="btn btn--primary btn--stripe">
                  <span>Continue to Secure Checkout</span>
                  <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                  </svg>
                </button>
              </div>

              <div class="checkout-legal-note">
                <p class="checkout-legal-title">Subscription Agreement Notice</p>
                <ul class="checkout-legal-list">
                  <li>You are purchasing a digital educational subscription</li>
                  <li>Your subscription may renew automatically</li>
                  <li>You may cancel within 3 days for eligible plans</li>
                  <li>
                    Refund eligibility is subject to our
                    <a
                      href="/refund-policy"
                      class="checkout-legal-link checkout-doc-link"
                      data-doc="refund"
                      >Refund Policy</a
                    >
                  </li>
                  <li>Subscription access is personal and may not be shared</li>
                </ul>
              </div>

              <p class="stripe-footnote">
                <svg class="info-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                Your payment details are never stored on our servers. All transactions are processed securely by Stripe.
              </p>
            </div>
          </section>
        </section>
      </main>

      <!-- Security Notice spacer (kept) -->
      <div
        class="checkout-center-row checkout-gap-2 checkout-mb-6 checkout-text-sm"
      ></div>
    </div>

    <!-- ===================== REFUND POLICY MODAL ===================== -->
    <div
      id="checkout-doc-modal"
      class="checkout-doc-modal hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="checkout-doc-title"
    >
      <div class="checkout-doc-card">
        <div class="checkout-doc-header">
          <h2 id="checkout-doc-title" class="checkout-doc-title">
            Refund Policy
          </h2>
          <div class="checkout-doc-actions">
            <button
              id="checkout-doc-lang"
              class="checkout-doc-lang"
              type="button"
            >
              FR
            </button>
            <button
              id="checkout-doc-close"
              class="checkout-doc-close"
              type="button"
            >
              Close
            </button>
          </div>
        </div>

        <div class="checkout-doc-body">
          <section data-doc-panel="refund" class="checkout-doc-panel">
            <div data-lang="en">
              <h3 class="checkout-doc-subtitle">Return and Refund Policy</h3>
              <p class="checkout-doc-updated">Last Updated: March 2026</p>
              <p class="checkout-doc-text">
                Welcome to SimpleTCF. This Return and Refund Policy explains
                your rights regarding subscription cancellations and refunds, in
                accordance with applicable Canadian consumer protection laws.
              </p>
              <p class="checkout-doc-text">
                By purchasing a subscription to SimpleTCF, you agree to the
                terms outlined in this policy.
              </p>
              <ol class="checkout-doc-list">
                <li>
                  <strong>Nature of Our Services</strong> â€” SimpleTCF provides
                  digital educational services, including practice exams,
                  interactive exercises, study materials, performance tracking
                  tools, and audio, reading, and writing training modules. Access
                  is granted immediately upon activation. Digital services are
                  considered consumed once access is granted, subject to
                  cancellation rights below.
                </li>
                <li>
                  <strong>Subscription Cancellation Rights</strong> â€” You may
                  cancel your subscription within 3 calendar days of your
                  initial purchase without providing a reason. The cancellation
                  period begins on the date your subscription is activated.
                  To request cancellation, email support@simpletcf.com.
                </li>
                <li>
                  <strong>Non-Refundable Plans</strong> â€” Certain entry-level or
                  promotional plans may be designated as non-refundable when
                  disclosed at purchase.
                </li>
                <li>
                  <strong>Refund Eligibility</strong> â€” Refunds are issued only
                  when requests are within the 3-day cooling-off period, the
                  subscription qualifies, and the account has not violated our
                  Terms of Service. Requests submitted after the cooling-off
                  period may be declined unless required by law.
                </li>
                <li>
                  <strong>Refund Processing</strong> â€” If approved, refunds are
                  issued within 14 business days using the original payment
                  method. Processor fees may be deducted where permitted by law.
                </li>
                <li>
                  <strong>Subscription Renewals</strong> â€” Subscriptions may
                  renew automatically. You authorize SimpleTCF to charge the
                  selected payment method unless cancelled before the next
                  billing cycle.
                </li>
                <li>
                  <strong>Account Sharing and Unauthorized Use</strong> â€”
                  Subscriptions are personal and may not be shared. If SimpleTCF
                  detects account sharing or abuse, we may terminate the account
                  without notice. Terminated accounts are not eligible for
                  refunds.
                </li>
                <li>
                  <strong>Service Access After Cancellation</strong> â€” Once
                  cancelled, access remains active until the end of the paid
                  period unless terminated for violations. No partial refunds
                  are issued after the cooling-off period.
                </li>
                <li>
                  <strong>Consumer Protection Compliance</strong> â€” This policy
                  does not limit rights granted under Canadian consumer
                  protection laws.
                </li>
                <li>
                  <strong>Contact Information</strong> â€” info@simpletcf.com | https://simpletcf.com
                </li>
              </ol>
            </div>
            <div data-lang="fr" class="hidden">
              <h3 class="checkout-doc-subtitle">Politique de retour et de remboursement</h3>
              <p class="checkout-doc-updated">Derniere mise a jour : mars 2026</p>
              <p class="checkout-doc-text">
                Bienvenue sur SimpleTCF. Cette politique de retour et de
                remboursement explique vos droits d'annulation et de
                remboursement, conforme aux lois canadiennes applicables.
              </p>
              <p class="checkout-doc-text">
                En achetant un abonnement SimpleTCF, vous acceptez cette
                politique.
              </p>
              <ol class="checkout-doc-list">
                <li>
                  <strong>Nature des services</strong> â€” SimpleTCF fournit des
                  services educatifs numeriques : examens pratiques, exercices
                  interactifs, supports d'etude, suivi de performance, et
                  modules audio, lecture et ecriture. L'acces est immediat. Les
                  services numeriques sont consideres consommes a l'activation,
                  sous reserve des droits d'annulation.
                </li>
                <li>
                  <strong>Droit d'annulation</strong> â€” Vous pouvez annuler dans
                  les 3 jours calendaires suivant l'achat. Le delai commence a
                  l'activation. Demande par email : support@simpletcf.com.
                </li>
                <li>
                  <strong>Plans non remboursables</strong> â€” Certains plans
                  promotionnels peuvent etre non remboursables si indique lors
                  de l'achat.
                </li>
                <li>
                  <strong>Eligibilite</strong> â€” Remboursement si demande dans le
                  delai, abonnement eligible, et respect des Conditions
                  d'utilisation. Les demandes apres le delai peuvent etre
                  refusees sauf exigence legale.
                </li>
                <li>
                  <strong>Traitement</strong> â€” Si approuve, remboursement sous
                  14 jours ouvrables via le moyen de paiement initial. Des frais
                  peuvent etre deduits si la loi l'autorise.
                </li>
                <li>
                  <strong>Renouvellements</strong> â€” Les abonnements peuvent se
                  renouveler automatiquement. Vous autorisez SimpleTCF a
                  prelever le moyen de paiement sauf annulation avant l'echeance.
                </li>
                <li>
                  <strong>Partage et usage non autorise</strong> â€” Les abonnements
                  sont personnels. En cas de partage ou d'abus, SimpleTCF peut
                  suspendre ou resilier sans remboursement.
                </li>
                <li>
                  <strong>Acces apres annulation</strong> â€” L'acces reste actif
                  jusqu'a la fin de la periode payee. Pas de remboursement
                  partiel apres le delai d'annulation.
                </li>
                <li>
                  <strong>Conformite</strong> â€” Cette politique ne limite pas les
                  droits prevus par la loi canadienne.
                </li>
                <li>
                  <strong>Contact</strong> â€” info@simpletcf.com | https://simpletcf.com
                </li>
              </ol>
            </div>
          </section>
        </div>
      </div>
    </div>

    <!-- Firebase initialization (config hardcoded) -->
    <script type="module" src="config.js"></script>
    <script type="module" src="db-service.js"></script>
    <script src="subscription-service.js"></script>
    <!-- Stripe payment service -->
    <script src="stripe-service.js"></script>
    <!-- Then app scripts -->
    <script type="module" src="script.js"></script>
    <script type="module" src="checkout.js"></script>
    <script>
      (function() {
        const modal = document.getElementById("checkout-doc-modal");
        const closeBtn = document.getElementById("checkout-doc-close");
        const langBtn = document.getElementById("checkout-doc-lang");
        const panels = Array.from(document.querySelectorAll(".checkout-doc-panel"));
        const links = Array.from(document.querySelectorAll(".checkout-doc-link"));

        let currentLang = "en";

        function setLang(lang) {
          currentLang = lang;
          langBtn.textContent = currentLang === "en" ? "FR" : "EN";
          panels.forEach((panel) => {
            const enBlock = panel.querySelector('[data-lang="en"]');
            const frBlock = panel.querySelector('[data-lang="fr"]');
            if (enBlock) enBlock.classList.toggle("hidden", lang !== "en");
            if (frBlock) frBlock.classList.toggle("hidden", lang !== "fr");
          });
        }

        function openPanel(docKey) {
          panels.forEach((panel) => {
            const isActive = panel.getAttribute("data-doc-panel") === docKey;
            panel.classList.toggle("hidden", !isActive);
          });
          setLang(currentLang);
          modal.classList.remove("hidden");
          document.body.classList.add("checkout-modal-open");
        }

        function closeModal() {
          modal.classList.add("hidden");
          document.body.classList.remove("checkout-modal-open");
        }

        links.forEach((link) => {
          link.addEventListener("click", (event) => {
            event.preventDefault();
            const docKey = link.getAttribute("data-doc");
            openPanel(docKey);
          });
        });

        closeBtn.addEventListener("click", closeModal);
        modal.addEventListener("click", (event) => {
          if (event.target === modal) closeModal();
        });
        langBtn.addEventListener("click", () => {
          setLang(currentLang === "en" ? "fr" : "en");
        });

        setLang("en");
      })();
    </script>
  </body>
</html>
